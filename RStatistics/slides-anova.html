<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Thomas Petzoldt" />
  <meta name="date" content="2021-12-14" />
  <title>One and two-way ANOVA with R</title>
  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
            pre > code.sourceCode { white-space: pre; position: relative; }
            pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
            pre > code.sourceCode > span:empty { height: 1.2em; }
            .sourceCode { overflow: visible; }
            code.sourceCode > span { color: inherit; text-decoration: inherit; }
            div.sourceCode { margin: 1em 0; }
            pre.sourceCode { margin: 0; }
            @media screen {
            div.sourceCode { overflow: auto; }
            }
            @media print {
            pre > code.sourceCode { white-space: pre-wrap; }
            pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
            }
            pre.numberSource code
              { counter-reset: source-line 0; }
            pre.numberSource code > span
              { position: relative; left: -4em; counter-increment: source-line; }
            pre.numberSource code > span > a:first-child::before
              { content: counter(source-line);
                position: relative; left: -1em; text-align: right; vertical-align: baseline;
                border: none; display: inline-block;
                -webkit-touch-callout: none; -webkit-user-select: none;
                -khtml-user-select: none; -moz-user-select: none;
                -ms-user-select: none; user-select: none;
                padding: 0 4px; width: 4em;
                color: #aaaaaa;
              }
            pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
            div.sourceCode
              {   }
            @media screen {
            pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
            }
            code span.al { color: #ff0000; font-weight: bold; } /* Alert */
            code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
            code span.at { color: #7d9029; } /* Attribute */
            code span.bn { color: #40a070; } /* BaseN */
            code span.bu { } /* BuiltIn */
            code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
            code span.ch { color: #4070a0; } /* Char */
            code span.cn { color: #880000; } /* Constant */
            code span.co { color: #60a0b0; font-style: italic; } /* Comment */
            code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
            code span.do { color: #ba2121; font-style: italic; } /* Documentation */
            code span.dt { color: #902000; } /* DataType */
            code span.dv { color: #40a070; } /* DecVal */
            code span.er { color: #ff0000; font-weight: bold; } /* Error */
            code span.ex { } /* Extension */
            code span.fl { color: #40a070; } /* Float */
            code span.fu { color: #06287e; } /* Function */
            code span.im { } /* Import */
            code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
            code span.kw { color: #007020; font-weight: bold; } /* Keyword */
            code span.op { color: #666666; } /* Operator */
            code span.ot { color: #007020; } /* Other */
            code span.pp { color: #bc7a00; } /* Preprocessor */
            code span.sc { color: #4070a0; } /* SpecialChar */
            code span.ss { color: #bb6688; } /* SpecialString */
            code span.st { color: #4070a0; } /* String */
            code span.va { color: #19177c; } /* Variable */
            code span.vs { color: #4070a0; } /* VerbatimString */
            code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
          </style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <script src="slides-anova_files/header-attrs-2.11/header-attrs.js"></script>
  <script src="slides-anova_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="slides-anova_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
  <script src="slides-anova_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
  <script src="slides-anova_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
  <script src="slides-anova_files/bootstrap-3.3.5/shim/respond.min.js"></script>
  <style>h1 {font-size: 34px;}
         h1.title {font-size: 38px;}
         h2 {font-size: 30px;}
         h3 {font-size: 24px;}
         h4 {font-size: 18px;}
         h5 {font-size: 16px;}
         h6 {font-size: 12px;}
         code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
         pre:not([class]) { background-color: white }</style>
  <link href="slides-anova_files/slidy-2/styles/slidy.css" rel="stylesheet" />
  <script src="slides-anova_files/slidy-2/scripts/slidy.js"></script>
  <script src="slides-anova_files/slidy_shiny-1/slidy_shiny.js"></script>
  <script src="slides-anova_files/kePrint-0.0.1/kePrint.js"></script>
  <link href="slides-anova_files/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
   href="tp_slidy.css" />
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">One and two-way ANOVA with R</h1>
  <p class="author">
Thomas Petzoldt
  </p>
  <p class="date">2021-12-14</p>
</div>
<div id="preface" class="slide section level2">
<h1>Preface</h1>
<ul>
<li>This HTML document is intended to amend the PDF lecture slides.</li>
<li>The “long slides”-format aims to make self-study easier. Compared to the pdf version more code is shown to improve reproducibility. Scroll down and then copy the code to your favorite R editor (e.g. RStudio).</li>
<li>Full source code of the slides is provided in R Markdown format using the “slidy” framework.</li>
<li>Photos and algae growth data were created as part of a highschool internship project, many thanks to C. Belger for his contribution.</li>
<li>Please send questions and comments to: <a href="https://tu-dresden.de/Members/thomas.petzoldt" class="uri">https://tu-dresden.de/Members/thomas.petzoldt</a></li>
</ul>
<h3 id="thank-you">Thank you!</h3>
<style>
 h2, h3 {
   color: #009de0;
   font-size: 40px;
}

div.vbox {
  float: left;
  height: 40%; width: 50%;
  margin-top: -220px;
}
div.hbox {
  width:60%;  margin-top: 0;
  margin-left:auto; margin-right:auto;
  height: 60%;
  border:1px solid silver;
  // background:#F0F0F0;
  overflow:auto;
  text-align:left;
  clear:both;
}
.math {
  font-size: 95%;
  padding-right: 1ex;
}
li::marker {
  color: orange;
}
</style>
</div>
<div id="anova-analysis-of-variances" class="slide section level2">
<h1>ANOVA – Analysis of Variances</h1>
<ul>
<li>Testing of complex hypothesis as a whole, e.g.:
<ul>
<li>more than two samples (multiple test problem),</li>
<li>several multiple factors (multiway ANOVA)</li>
<li>elimination of covariates (ANCOVA)</li>
<li>fixed and/or random effects (variance decomposition methods, mixed effects models)</li>
</ul></li>
<li>Different application scenarios:
<ul>
<li>explorative use: Which influence factors are important?</li>
<li>descriptive use: Fitting of models for process description and forecasting.</li>
<li>significance tests.</li>
</ul></li>
<li>ANOVA methods are (in most cases) based on linear models.</li>
</ul>
</div>
<div id="a-practical-example" class="slide section level2">
<h1>A practical example</h1>
<p><img src="img/ansaetze.jpg" /></p>
<h3 id="scientific-question">Scientific question</h3>
<p>Find a suitable medium for growth experiments with green algae:</p>
<ul>
<li>cheap, easy to handle</li>
<li>suitable for students courses and classroom experiments</li>
</ul>
<h3 id="idea">Idea</h3>
<ul>
<li>use a commercial fertilizer with the main nutrients N and P</li>
<li>mineral water with trace elements</li>
<li>does non-sparkling mineral water contain enough <span class="math inline">\(\mathrm{HCO_3^-}\)</span>?</li>
<li>test how to improve (<span class="math inline">\(\mathrm{CO_2}\)</span>) availability for photosynthesis</li>
</ul>
</div>
<div id="application" class="slide section level2">
<h1>Application</h1>
<h3 id="different-treatments">7 Different treatments</h3>
<ul>
<li>fertilizer solution in closed bottles</li>
<li>fertilizer solution in open bottles (<span class="math inline">\(\mathrm{CO_2}\)</span> from air)</li>
<li>fertilizer + sugar (organic C source)</li>
<li>fertilizer + additional <span class="math inline">\(\mathrm{HCO_3^-}\)</span> (add <span class="math inline">\(\mathrm{CaCO_3}\)</span> to sparkling mineral water)</li>
<li>a standard algae growth medium (“Basal medium”) for comparison</li>
<li>deionized (“destilled”) water and tap water for comparison</li>
</ul>
</div>
<div id="experimental-design" class="slide section level2">
<h1>Experimental design</h1>
<div align="center">
<p><img src="img/ruettler.jpg" height=600></p>
</div>
<div style="padding-left: 10ex;">
<ul>
<li>each treatment with 3 replicates</li>
<li>randomized experiment on a shaker</li>
<li>16:8 light:dark-cycle</li>
<li>measurement directly in the bottles using a self-made <a href="https://tpetzoldt.github.io/growthlab/doc/versuchsaufbau.html">turbidity meter</a></li>
</ul>
</div>
</div>
<div id="results" class="slide section level2">
<h1>Results</h1>
<div class="vbox">

</div>
<div class="hbox">
<p><img src="img/ansaetze2.jpg" /> Fertilizer – Open Bottle – F. + Sugar – F. + CaCO3 – Basal medium – A. dest – Tap water</p>
</div>
</div>
<div id="the-data-set" class="slide section level2">
<h1>The data set</h1>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Data set: Growth from day 2 to day 6 (in relative units)
</caption>
<thead>
<tr>
<th style="text-align:left;">
treat
</th>
<th style="text-align:right;">
replicate 1
</th>
<th style="text-align:right;">
replicate 2
</th>
<th style="text-align:right;">
replicate 3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Fertilizer
</td>
<td style="text-align:right;">
0.020
</td>
<td style="text-align:right;">
-0.217
</td>
<td style="text-align:right;">
-0.273
</td>
</tr>
<tr>
<td style="text-align:left;">
F. open
</td>
<td style="text-align:right;">
0.940
</td>
<td style="text-align:right;">
0.780
</td>
<td style="text-align:right;">
0.555
</td>
</tr>
<tr>
<td style="text-align:left;">
F.+sugar
</td>
<td style="text-align:right;">
0.188
</td>
<td style="text-align:right;">
-0.100
</td>
<td style="text-align:right;">
0.020
</td>
</tr>
<tr>
<td style="text-align:left;">
F.+CaCO3
</td>
<td style="text-align:right;">
0.245
</td>
<td style="text-align:right;">
0.236
</td>
<td style="text-align:right;">
0.456
</td>
</tr>
<tr>
<td style="text-align:left;">
Bas.med.
</td>
<td style="text-align:right;">
0.699
</td>
<td style="text-align:right;">
0.727
</td>
<td style="text-align:right;">
0.656
</td>
</tr>
<tr>
<td style="text-align:left;">
A.dest
</td>
<td style="text-align:right;">
-0.010
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
-0.010
</td>
</tr>
<tr>
<td style="text-align:left;">
Tap water
</td>
<td style="text-align:right;">
0.030
</td>
<td style="text-align:right;">
-0.070
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<ul>
<li>NA means “not available,” i.e. a missing value</li>
<li>the crosstable structure is compact and nice on a slide, but not suitable for data analysis</li>
<li>therefore, we use the long table format instead</li>
</ul>
</div>
<div id="data-in-long-format" class="slide section level2">
<h1>Data in long format</h1>
<div class="left" style="float:left;width:48%">
<p style="padding-bottom: 10ex">
 
</p>
<h3 id="advantages">Advantages</h3>
<ul>
<li>looks “stupid” but is better for data analysis</li>
<li>dependend <strong>growth</strong> and explanation variable <strong>treat</strong> clearly visible</li>
<li>easily extensible to <span class="math inline">\(&gt;1\)</span> explanation variable</li>
</ul>
</div>
<div class="right" style="float:left;width:48%">
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Data set: Growth from day 2 to day 6 (in relative units)
</caption>
<thead>
<tr>
<th style="text-align:left;">
treat
</th>
<th style="text-align:right;">
rep
</th>
<th style="text-align:right;">
growth
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Fertilizer
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.020
</td>
</tr>
<tr>
<td style="text-align:left;">
Fertilizer
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.217
</td>
</tr>
<tr>
<td style="text-align:left;">
Fertilizer
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-0.273
</td>
</tr>
<tr>
<td style="text-align:left;">
F. open
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.940
</td>
</tr>
<tr>
<td style="text-align:left;">
F. open
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.780
</td>
</tr>
<tr>
<td style="text-align:left;">
F. open
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.555
</td>
</tr>
<tr>
<td style="text-align:left;">
F.+sugar
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.188
</td>
</tr>
<tr>
<td style="text-align:left;">
F.+sugar
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.100
</td>
</tr>
<tr>
<td style="text-align:left;">
F.+sugar
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.020
</td>
</tr>
<tr>
<td style="text-align:left;">
F.+CaCO3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.245
</td>
</tr>
<tr>
<td style="text-align:left;">
F.+CaCO3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.236
</td>
</tr>
<tr>
<td style="text-align:left;">
F.+CaCO3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.456
</td>
</tr>
<tr>
<td style="text-align:left;">
Bas.med.
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.699
</td>
</tr>
<tr>
<td style="text-align:left;">
Bas.med.
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.727
</td>
</tr>
<tr>
<td style="text-align:left;">
Bas.med.
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.656
</td>
</tr>
<tr>
<td style="text-align:left;">
A.dest
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.010
</td>
</tr>
<tr>
<td style="text-align:left;">
A.dest
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
A.dest
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-0.010
</td>
</tr>
<tr>
<td style="text-align:left;">
Tap water
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.030
</td>
</tr>
<tr>
<td style="text-align:left;">
Tap water
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.070
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="the-data-in-r" class="slide section level2">
<h1>The data in R</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">treat  =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;Fertilizer&quot;</span>, <span class="st">&quot;Fertilizer&quot;</span>, <span class="st">&quot;Fertilizer&quot;</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;F. open&quot;</span>, <span class="st">&quot;F. open&quot;</span>, <span class="st">&quot;F. open&quot;</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;F.+sugar&quot;</span>, <span class="st">&quot;F.+sugar&quot;</span>, <span class="st">&quot;F.+sugar&quot;</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;F.+CaCO3&quot;</span>, <span class="st">&quot;F.+CaCO3&quot;</span>, <span class="st">&quot;F.+CaCO3&quot;</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Bas.med.&quot;</span>, <span class="st">&quot;Bas.med.&quot;</span>, <span class="st">&quot;Bas.med.&quot;</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;A.dest&quot;</span>, <span class="st">&quot;A.dest&quot;</span>, <span class="st">&quot;A.dest&quot;</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Tap water&quot;</span>, <span class="st">&quot;Tap water&quot;</span>),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Fertilizer&quot;</span>, <span class="st">&quot;F. open&quot;</span>, <span class="st">&quot;F.+sugar&quot;</span>, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;F.+CaCO3&quot;</span>, <span class="st">&quot;Bas.med.&quot;</span>, <span class="st">&quot;A.dest&quot;</span>, <span class="st">&quot;Tap water&quot;</span>)),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">rep   =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">growth =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.217</span>, <span class="sc">-</span><span class="fl">0.273</span>, <span class="fl">0.94</span>, <span class="fl">0.78</span>, <span class="fl">0.555</span>, <span class="fl">0.188</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.02</span>, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>             <span class="fl">0.245</span>, <span class="fl">0.236</span>, <span class="fl">0.456</span>, <span class="fl">0.699</span>, <span class="fl">0.727</span>, <span class="fl">0.656</span>, <span class="sc">-</span><span class="fl">0.01</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.01</span>, <span class="fl">0.03</span>, <span class="sc">-</span><span class="fl">0.07</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>… can be read from a <strong>csv</strong>-file or entered directly in the code.</p>
</div>
<div id="visualization" class="slide section level2">
<h1>Visualization</h1>
<p>We can try a <code>boxplot</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(growth <span class="sc">~</span> treat, <span class="at">data =</span> dat)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-5-1.png" width="768" /></p>
<p>But as we have only 2-3 replicates per box, it is better to use <code>stripchart</code> that shows all individual values:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(growth <span class="sc">~</span> treat, <span class="at">data =</span> dat, <span class="at">vertical =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-6-1.png" width="768" /></p>
</div>
<div id="statistical-approach-and-the-bonferroni-law" class="slide section level2">
<h1>Statistical approach and the Bonferroni law</h1>
<h3 id="questions">Questions</h3>
<ul>
<li>Are the treatments different?</li>
<li>Which medium is the best?</li>
<li>Is the best medium significantly better than the others?</li>
</ul>
<h3 id="hypotheses">Hypotheses</h3>
<ul>
<li><span class="math inline">\(H_0\)</span> growth is the same in all treatments</li>
<li><span class="math inline">\(H_A\)</span> differences between media</li>
</ul>
<h3 id="why-cant-we-apply-just-several-t-tests">Why can’t we apply just several t-tests?</h3>
<ul>
<li>If we have 7 treatments and want to test all against each other, we would need <span class="math inline">\(7 \cdot (7 - 1) / 2 = 21\)</span>  tests.</li>
<li>If we set <span class="math inline">\(\alpha = 0.05\)</span> we will get 5% false positives, i.e. one of 20 tests is on average false positive</li>
<li>This means that we do N tests, we may increase the overall <span class="math inline">\(\alpha\)</span> error in the worst case to a value of <span class="math inline">\(N\alpha\)</span>.</li>
<li>This is called <strong>alpha-error-inflation</strong> or the <strong>Bonferroni</strong> law:</li>
</ul>
<p><span class="math display">\[
\alpha_{total} \le \sum_{i=1}^{N} \alpha_i = N \cdot \alpha
\]</span></p>
<ul>
<li>If we ignore the Bonferroni law, we end in <strong>statistical fishing</strong> i.e. we get spurious results just by chance.</li>
</ul>
<h3 id="solutions">Solutions</h3>
<ul>
<li>One approach can be to down-correct the alpha errors so that <span class="math inline">\(\alpha_{total} = 0.05\)</span>: Bonferroni rule</li>
<li>The preferred approach is to use a method that does all tests simultanaeously: the ANOVA.</li>
</ul>
</div>
<div id="anova-analysis-of-variances-1" class="slide section level2">
<h1>ANOVA: Analysis of variances</h1>
<h3 id="basic-idea">Basic Idea</h3>
<ul>
<li>Split the total variance into effect(s) and errors:</li>
</ul>
<p><span class="math display">\[
s_y^2 = s^2_\mathrm{effect} + s^2_{\varepsilon}
\]</span></p>
<ul>
<li>The most surprising is, that we use variances to compare mean values. The reason for this is, that differences of means contribute to the total variance of the whole sample. Sometimes, the variance components are also called <strong>variance within</strong> (<span class="math inline">\(s^2_\varepsilon\)</span>) and variance <strong>between</strong> samples.</li>
<li>The way how to separate variances is a linear model.</li>
</ul>
<p style="padding-bottom: 5ex">
 
</p>
<h3 id="example">Example</h3>
<p>We have two brands of Clementines from a shop “E,” that we encode as “EB” and “EP.” We want to know whether the premium brand (“P”) and the basic brand (“B”) have a different weight.</p>
<p>Instead of a t-test we encode “EB” with 1 and “EP” with 2.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>clem <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">brand =</span> <span class="fu">c</span>(<span class="st">&quot;EP&quot;</span>, <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EB&quot;</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EP&quot;</span>, <span class="st">&quot;EP&quot;</span>, <span class="st">&quot;EP&quot;</span>, <span class="st">&quot;EP&quot;</span>, <span class="st">&quot;EP&quot;</span>, <span class="st">&quot;EP&quot;</span>, <span class="st">&quot;EP&quot;</span>, <span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EP&quot;</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">88</span>, <span class="dv">96</span>, <span class="dv">100</span>, <span class="dv">96</span>, <span class="dv">90</span>, <span class="dv">100</span>, <span class="dv">92</span>, <span class="dv">92</span>, <span class="dv">102</span>, <span class="dv">99</span>, <span class="dv">86</span>, <span class="dv">89</span>, <span class="dv">99</span>, <span class="dv">89</span>, <span class="dv">75</span>, <span class="dv">80</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>             <span class="dv">81</span>, <span class="dv">96</span>, <span class="dv">82</span>, <span class="dv">98</span>, <span class="dv">80</span>, <span class="dv">107</span>, <span class="dv">88</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>clem<span class="sc">$</span>code <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(clem<span class="sc">$</span>brand))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(weight <span class="sc">~</span> code, <span class="at">data =</span> clem, <span class="at">axe =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> code, <span class="at">data =</span> clem)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;EB&quot;</span>, <span class="st">&quot;EP&quot;</span>)); <span class="fu">axis</span>(<span class="dv">2</span>); <span class="fu">box</span>()</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(m, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-7-1.png" width="768" /></p>
<h3 id="total-variance">Total variance</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(var_tot <span class="ot">&lt;-</span> <span class="fu">var</span>(clem<span class="sc">$</span>weight))</span></code></pre></div>
<pre><code>## [1] 68.98814</code></pre>
<h3 id="residual-variance-alias-within-variance">Residual variance (alias “within variance”)</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(var_res <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">residuals</span>(m)))</span></code></pre></div>
<pre><code>## [1] 43.25</code></pre>
<h3 id="between-variance-or-explained-variance">Between variance or explained variance</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> var_res <span class="sc">/</span> var_tot</span></code></pre></div>
<pre><code>## [1] 0.3730807</code></pre>
<p><strong>Exercise:</strong></p>
<ul>
<li>Perform a t-Test for the two Clementine brands</li>
<li>Compare the p-value of the t-test with the p-value of an ANOVA</li>
</ul>
</div>
<div id="anova-in-r" class="slide section level2">
<h1>ANOVA in R</h1>
<p>Back to the algae growth data. Let’s call the linear model <code>m</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> treat, <span class="at">data=</span>dat)</span></code></pre></div>
<p>We can then print the coefficients of the linear model with <code>summary(m)</code>, but the more common way is to use the <code>anova</code>function</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: growth
##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## treat      6 2.35441 0.39240  25.045 1.987e-06 ***
## Residuals 13 0.20368 0.01567                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The ANOVA table shows the F-tests testing for significance of all factors. In the table above, we have only one single factor.</p>
<p>We see that the treatment had a significant effect.</p>
</div>
<div id="posthoc-tests" class="slide section level2">
<h1>Posthoc tests</h1>
<p>The test above showed only, that the <strong>factor</strong> “treatment” had a significant effect, but we don’t know which <strong>levels</strong> of the factor are different. Here we apply a so-called posthoc test.</p>
<p>Different posthoc tests exist, here we use the <strong>Tukey HSD test</strong> that is the most common.</p>
<p>The <code>TukeyHSD</code> function has a numerical and a graphical output.</p>
<h3 id="tukey-hsd-test">Tukey HSD test</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tk <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(<span class="fu">aov</span>(m))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>tk</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = m)
## 
## $treat
##                             diff         lwr         upr     p adj
## F. open-Fertilizer    0.91500000  0.56202797  1.26797203 0.0000103
## F.+sugar-Fertilizer   0.19266667 -0.16030537  0.54563870 0.5211198
## F.+CaCO3-Fertilizer   0.46900000  0.11602797  0.82197203 0.0069447
## Bas.med.-Fertilizer   0.85066667  0.49769463  1.20363870 0.0000231
## A.dest-Fertilizer     0.15000000 -0.20297203  0.50297203 0.7579063
## Tap water-Fertilizer  0.13666667 -0.25796806  0.53130140 0.8837597
## F.+sugar-F. open     -0.72233333 -1.07530537 -0.36936130 0.0001312
## F.+CaCO3-F. open     -0.44600000 -0.79897203 -0.09302797 0.0102557
## Bas.med.-F. open     -0.06433333 -0.41730537  0.28863870 0.9943994
## A.dest-F. open       -0.76500000 -1.11797203 -0.41202797 0.0000721
## Tap water-F. open    -0.77833333 -1.17296806 -0.38369860 0.0001913
## F.+CaCO3-F.+sugar     0.27633333 -0.07663870  0.62930537 0.1727182
## Bas.med.-F.+sugar     0.65800000  0.30502797  1.01097203 0.0003363
## A.dest-F.+sugar      -0.04266667 -0.39563870  0.31030537 0.9994197
## Tap water-F.+sugar   -0.05600000 -0.45063473  0.33863473 0.9985686
## Bas.med.-F.+CaCO3     0.38166667  0.02869463  0.73463870 0.0307459
## A.dest-F.+CaCO3      -0.31900000 -0.67197203  0.03397203 0.0879106
## Tap water-F.+CaCO3   -0.33233333 -0.72696806  0.06230140 0.1247914
## A.dest-Bas.med.      -0.70066667 -1.05363870 -0.34769463 0.0001792
## Tap water-Bas.med.   -0.71400000 -1.10863473 -0.31936527 0.0004507
## Tap water-A.dest     -0.01333333 -0.40796806  0.38130140 0.9999997</code></pre>
<h3 id="graphical-output">Graphical output</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">las =</span> <span class="dv">1</span>)             <span class="co"># las = 1 make y annotation horizontal</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">1</span>)) <span class="co"># more space at the left for axis annotation</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tk)</span></code></pre></div>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-14-1.png" width="768" /></p>
</div>
<div id="anova-assumptions-and-diagnostics" class="slide section level2">
<h1>ANOVA assumptions and diagnostics</h1>
<p>The assumptions of the ANOVA are the same as for the linear model. In short:</p>
<ol style="list-style-type: decimal">
<li>Independence of errors</li>
<li>Variance homogeneity</li>
<li>Approximate normality of errors</li>
</ol>
<p>Again, graphical methods are preferred. The easiest is <code>plot(m)</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m, <span class="at">which=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-15-1.png" width="768" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m, <span class="at">which=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-16-1.png" width="768" /></p>
<p>It is also possible to test variance homogeneity. Instead of an F-test that can only compare two variances, we need a test that can compare more than two, for example the Fligner-Killeen-test:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fligner.test</span>(growth <span class="sc">~</span> treat, <span class="at">data=</span>dat)</span></code></pre></div>
<pre><code>## 
##  Fligner-Killeen test of homogeneity of variances
## 
## data:  growth by treat
## Fligner-Killeen:med chi-squared = 4.2095, df = 6, p-value = 0.6483</code></pre>
</div>
<div id="one-way-anova-with-heterogeneous-variances" class="slide section level2">
<h1>One-way ANOVA with heterogeneous variances</h1>
<p>If variances are not equal we can use an extension of the Welch test for <span class="math inline">\(\ge 2\)</span> samples, in R called <code>oneway.test</code> instead of the one-way ANOVA :</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oneway.test</span>(growth <span class="sc">~</span> treat, <span class="at">data=</span>dat)</span></code></pre></div>
<pre><code>## 
##  One-way analysis of means (not assuming equal variances)
## 
## data:  growth and treat
## F = 115.09, num df = 6.0000, denom df = 4.6224, p-value = 6.57e-05</code></pre>
</div>
<div id="two-way-anova" class="slide section level2">
<h1>Two-way ANOVA</h1>
<ul>
<li>Example from a statistics text book <span class="citation">(Crawley, 2002)</span></li>
<li>Effects of diet and coat color on growth of Hamsters in gramm per time (constructed data set)</li>
</ul>
<div style="align: center">
<p><img src="img/hams-crosstable.jpg" alt="Hamster growth" style="width:30%"></p>
</div>
<ul>
<li>Factorial experiment (<strong>with replicates</strong>)</li>
<li>Each factor combination (cell) contains more than one observation.</li>
</ul>
<p>Without replication: only one experiment per factor combination. This is possible, but does not allow to identify interaction effects.</p>
</div>
<div id="tidy-data" class="slide section level2">
<h1>Tidy data</h1>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>hams <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">No =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">growth =</span> <span class="fu">c</span>(<span class="fl">6.6</span>, <span class="fl">7.2</span>, <span class="fl">6.9</span>, <span class="fl">8.3</span>, <span class="fl">7.9</span>, <span class="fl">9.2</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                            <span class="fl">8.3</span>, <span class="fl">8.7</span>, <span class="fl">8.1</span>, <span class="fl">8.5</span>, <span class="fl">9.1</span>, <span class="fl">9.0</span>),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diet =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="at">each=</span><span class="dv">2</span>),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">coat =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;light&quot;</span>, <span class="st">&quot;dark&quot;</span>), <span class="at">each=</span><span class="dv">6</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                   )</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Data set: Growth of hamsters (in gramm)
</caption>
<thead>
<tr>
<th style="text-align:right;">
No
</th>
<th style="text-align:right;">
growth
</th>
<th style="text-align:left;">
diet
</th>
<th style="text-align:left;">
coat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6.6
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
light
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7.2
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
light
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6.9
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
light
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
8.3
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
light
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7.9
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
light
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
9.2
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
light
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8.3
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
dark
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8.7
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
dark
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8.1
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
dark
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8.5
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
dark
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
9.1
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
dark
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
9.0
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
dark
</td>
</tr>
</tbody>
</table>
</div>
<div id="visualization-and-anova" class="slide section level2">
<h1>Visualization and ANOVA</h1>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-22-1.png" width="768" /></p>
<h3 id="anova">ANOVA</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> coat <span class="sc">*</span> diet, <span class="at">data =</span> hams)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: growth
##           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
## coat       1 2.61333 2.61333  7.2258 0.03614 *
## diet       2 2.66000 1.33000  3.6774 0.09069 .
## coat:diet  2 0.68667 0.34333  0.9493 0.43833  
## Residuals  6 2.17000 0.36167                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<h3 id="interaction-plot">Interaction plot</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(hams, <span class="fu">interaction.plot</span>(diet, coat, growth, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;brown&quot;</span>, <span class="st">&quot;orange&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-24-1.png" width="768" /></p>
</div>
<div id="diagnostics" class="slide section level2">
<h1>Diagnostics</h1>
<h3 id="assumptions">Assumptions</h3>
<ol style="list-style-type: decimal">
<li>Independence of measurements (within samples)</li>
<li>Variance homogeneity of residuals</li>
<li>Normal distribution of residuals</li>
</ol>
<p>Note: test of assumptions only possible after fitting the model.</p>
<p>⇒ Fit the ANOVA model first, then check if it was correct!</p>
<h3 id="diagnostic-tools">Diagnostic tools</h3>
<ul>
<li>Box plot</li>
<li>Plot of residuals vs. mean values</li>
<li>Q-Q-plot of residuals</li>
<li>Fligner-Killeen test (alternative: some people recommend the Levene-Test)</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(m)<span class="sc">~</span><span class="fu">fitted</span>(m))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-25-1.png" width="768" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fligner.test</span>(growth <span class="sc">~</span> <span class="fu">interaction</span>(coat, diet), <span class="at">data=</span>hams)</span></code></pre></div>
<pre><code>## 
##  Fligner-Killeen test of homogeneity of variances
## 
## data:  growth by interaction(coat, diet)
## Fligner-Killeen:med chi-squared = 10.788, df = 5, p-value = 0.05575</code></pre>
<p>The residuals look ok and the p-value of the Fligner test are not significant at the <span class="math inline">\(p=0.05\)</span> level, so everything looks fine.</p>
<p>However, pre-tests are generally problematic for theoretical reasons, as null hypotheses <span class="math inline">\(H_0\)</span> can only be rejected and not ultimately confirmed. Furthermore, <span class="math inline">\(p\)</span> is close to the threshold value and, even more important, the data set is very small. This leaves us with some uncertainty, typical for such cases. It can only be overcome with careful thinking and some experience. It is always a good idea to discuss results with colleagues and supervisors.</p>
</div>
<div id="sequential-holm-bonferroni-method" class="slide section level2">
<h1>Sequential Holm-Bonferroni method</h1>
<ul>
<li>Also called Holm procedure <span class="citation">(Holm, 1979)</span></li>
<li>Easy to use</li>
<li>Can be applied to any multiple test problem</li>
<li>Less conservative that ordinary Bonferroni correction, but …</li>
<li>… still a very conservative approach</li>
<li>see also <a href="https://en.wikipedia.org/wiki/Holm%E2%80%93Bonferroni_method">Wikipedia</a></li>
</ul>
<h3 id="algorithm">Algorithm</h3>
<ol style="list-style-type: decimal">
<li>Select smallest <span class="math inline">\(p\)</span> out of all <span class="math inline">\(n\)</span> <span class="math inline">\(p\)</span>-values</li>
<li>If <span class="math inline">\(p \cdot n &lt; \alpha\)</span> <span class="math inline">\(\Rightarrow\)</span> significant, else <bf>STOP</bf></li>
<li>Set <span class="math inline">\(n − 1 \rightarrow n\)</span>, remove smallest <span class="math inline">\(p\)</span> from the list and go to step 1.</li>
</ol>
</div>
<div id="example-1" class="slide section level2">
<h1>Example</h1>
<p>Growth rate per day (<span class="math inline">\(d^{-1}\)</span>) of blue-green algae cultures (<em>Pseudanabaena</em>) after adding toxic peptides from another blue-green algae (<em>Microcystis</em>).</p>
<p>The original hypothesis was that Microcystin LR (MCYST) or a derivative of it (Substance A) inhibits growth.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mcyst <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">treat =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Control&quot;</span>, <span class="dv">5</span>),</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">rep</span>(<span class="st">&quot;MCYST&quot;</span>, <span class="dv">5</span>),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">rep</span>(<span class="st">&quot;Subst A&quot;</span>, <span class="dv">5</span>)),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;MCYST&quot;</span>, <span class="st">&quot;Subst A&quot;</span>)),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mu   =</span> <span class="fu">c</span>(<span class="fl">0.086</span>, <span class="fl">0.101</span>, <span class="fl">0.086</span>, <span class="fl">0.086</span>, <span class="fl">0.099</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                               <span class="fl">0.092</span>, <span class="fl">0.088</span>, <span class="fl">0.093</span>, <span class="fl">0.088</span>, <span class="fl">0.086</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                               <span class="fl">0.095</span>, <span class="fl">0.102</span>, <span class="fl">0.106</span>, <span class="fl">0.106</span>, <span class="fl">0.106</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                     )</span></code></pre></div>
<h3 id="approach-1-one-way-anova">Approach 1: one-way ANOVA</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(mu <span class="sc">~</span> treat, <span class="at">data=</span>mcyst)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: mu
##           Df     Sum Sq    Mean Sq F value   Pr(&gt;F)   
## treat      2 0.00053293 2.6647e-04   8.775 0.004485 **
## Residuals 12 0.00036440 3.0367e-05                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(<span class="fu">aov</span>(m)))</span></code></pre></div>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-28-1.png" width="768" /></p>
<h3 id="approach-2-multiple-t-tests-with-sequential-bonferroni-correction">Approach 2: multiple t-Tests with sequential Bonferroni correction</h3>
<p>We separate the data set in single subsets:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>Control <span class="ot">&lt;-</span> mcyst<span class="sc">$</span>mu[mcyst<span class="sc">$</span>treat <span class="sc">==</span> <span class="st">&quot;Control&quot;</span>]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>MCYST   <span class="ot">&lt;-</span> mcyst<span class="sc">$</span>mu[mcyst<span class="sc">$</span>treat <span class="sc">==</span> <span class="st">&quot;MCYST&quot;</span>]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>SubstA  <span class="ot">&lt;-</span> mcyst<span class="sc">$</span>mu[mcyst<span class="sc">$</span>treat <span class="sc">==</span> <span class="st">&quot;Subst A&quot;</span>]</span></code></pre></div>
<p>and perform 3 t-Tests:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(Control, MCYST)<span class="sc">$</span>p.value</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(Control, SubstA)<span class="sc">$</span>p.value</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(MCYST, SubstA)<span class="sc">$</span>p.value</span></code></pre></div>
<p>The following shows the raw p-values without correction:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p1, p2, p3)</span></code></pre></div>
<pre><code>## [1] 0.576275261 0.027378832 0.001190592</code></pre>
<p>and with Holm correction:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(p1, p2, p3))</span></code></pre></div>
<pre><code>## [1] 0.576275261 0.054757664 0.003571775</code></pre>
</div>
<div id="conclusions" class="slide section level2">
<h1>Conclusions</h1>
<h3 id="statistical-methods">Statistical methods</h3>
<ul>
<li>In case of Holm-corrected t-tests, only a signle p-value (MCYST vs. Subst A) remains significant. This indicates that in this case, Holm’s method is more conservative than TukeyHSD (only one compared to two significant) effects.</li>
<li>An ANOVA with posthoc test is in general preferred,</li>
<li>but the sequential Holm-Bonferroni can be helpful in special cases.</li>
<li>Moreover, it demonstrates clearly that massive multiple testing needs to be avoided.</li>
</ul>
<p><span class="math inline">\(\Rightarrow\)</span> ANOVA is to be preferred, when possible.</p>
<h3 id="interpretation">Interpretation</h3>
<ul>
<li>Regarding our original hypothesis, we can see that MCYST and SubstA did not inhibit growth of <em>Pseudanabaena</em>. In fact SubstA stimulated growth.</li>
<li>This was contrary to our expectations – the biological reason was then found 10 years later.</li>
</ul>
<p>More about this can be found in <span class="citation">Jähnichen et al. (2001)</span>, <span class="citation">Jähnichen et al. (2007)</span>, <span class="citation">Jähnichen et al. (2011)</span>, <span class="citation">Zilliges et al. (2011)</span> or <span class="citation">Dziallas &amp; Grossart (2011)</span>.</p>
</div>
<div id="ancova" class="slide section level2">
<h1>ANCOVA</h1>
<h3 id="statistical-question">Statistical question</h3>
<ul>
<li>Comparison of regression lines</li>
<li>Similar to ANOVA, but contains also <strong>metric</strong> variables (covariates)</li>
</ul>
<h3 id="example-2">Example</h3>
<p>Annette Dobson’s birthweight data. A data set from a statistics textbook <span class="citation">(Dobson, 2013)</span>, birth weight of boys and girls in dependence of the pregnancy week.</p>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-33-1.png" width="768" /></p>
<hr>
</hr>
<p>The data set is found at different places on the internet and in different versions.</p>
<p>Here the version that is found in an R demo: <code>demo(lm.glm)</code></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Birth Weight Data see stats/demo/lm.glm.R</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>dobson <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">week =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">38</span>, <span class="dv">40</span>, <span class="dv">35</span>, <span class="dv">36</span>, <span class="dv">37</span>, <span class="dv">41</span>, <span class="dv">40</span>, <span class="dv">37</span>, <span class="dv">38</span>, <span class="dv">40</span>, <span class="dv">38</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>     <span class="dv">40</span>, <span class="dv">36</span>, <span class="dv">40</span>, <span class="dv">38</span>, <span class="dv">42</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">37</span>, <span class="dv">36</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">2968</span>, <span class="dv">2795</span>, <span class="dv">3163</span>, <span class="dv">2925</span>, <span class="dv">2625</span>, <span class="dv">2847</span>, <span class="dv">3292</span>, <span class="dv">3473</span>, <span class="dv">2628</span>, <span class="dv">3176</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">3421</span>, <span class="dv">2975</span>, <span class="dv">3317</span>, <span class="dv">2729</span>, <span class="dv">2935</span>, <span class="dv">2754</span>, <span class="dv">3210</span>, <span class="dv">2817</span>, <span class="dv">3126</span>, <span class="dv">2539</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>        <span class="dv">2412</span>, <span class="dv">2991</span>, <span class="dv">2875</span>, <span class="dv">3231</span>),</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">12</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>))</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="summary-linear-regression-anova-and-ancova" class="slide section level2">
<h1>Summary: Linear regression, ANOVA and ANCOVA</h1>
<ul>
<li>ANCOVA (analysis of covariance) deals with the comparison of regression lines</li>
<li>Simply speaking, we can distinguish the following:
<ul>
<li>independent variables have metric scale: linear regression</li>
<li>independent variables all nominal (factor): ANOVA</li>
<li>independent variables are mixed nominal and metric: ANCOVA</li>
</ul></li>
</ul>
<p>For the linear models discussed so far, the <strong>dependent</strong> variable is always metric, while binary or nominal dependent variables can be handled with generalized linear models (GLM).</p>
</div>
<div id="anette-dobsons-birthweight-data" class="slide section level2">
<h1>Anette Dobson’s birthweight data</h1>
<p>Why not just using a t-test?</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(weight <span class="sc">~</span> sex,<span class="at">data=</span>dobson, <span class="at">ylab=</span><span class="st">&quot;weight&quot;</span>)</span></code></pre></div>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-35-1.png" width="768" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(weight <span class="sc">~</span> sex, <span class="at">data=</span>dobson, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  weight by sex
## t = 0.97747, df = 22, p-value = 0.339
## alternative hypothesis: true difference in means between group M and group F is not equal to 0
## 95 percent confidence interval:
##  -126.3753  351.7086
## sample estimates:
## mean in group M mean in group F 
##        3024.000        2911.333</code></pre>
<p>The box plot shows much overlap and the difference is not significant, because the t-test ignores important information: the pregnancy week.</p>
</div>
<div id="ancova-makes-use-of-covariates" class="slide section level2">
<h1>ANCOVA makes use of covariates</h1>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> week <span class="sc">*</span> sex, <span class="at">data=</span>dobson)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: weight
##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## week       1 1013799 1013799 31.0779 1.862e-05 ***
## sex        1  157304  157304  4.8221   0.04006 *  
## week:sex   1    6346    6346  0.1945   0.66389    
## Residuals 20  652425   32621                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-37-1.png" width="768" /></p>
<h3 id="how-this-works">How this works</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(weight <span class="sc">~</span> week, <span class="at">data=</span>dobson, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>)[<span class="fu">as.numeric</span>(sex)], <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ week * sex, data = dobson)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -246.69 -138.11  -39.13  176.57  274.28 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1268.67    1114.64  -1.138 0.268492    
## week          111.98      29.05   3.855 0.000986 ***
## sexF         -872.99    1611.33  -0.542 0.593952    
## week:sexF      18.42      41.76   0.441 0.663893    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 180.6 on 20 degrees of freedom
## Multiple R-squared:  0.6435, Adjusted R-squared:   0.59 
## F-statistic: 12.03 on 3 and 20 DF,  p-value: 0.000101</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">coef</span>(m)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span>p[<span class="dv">1</span>],      <span class="at">b=</span>p[<span class="dv">2</span>],      <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span>p[<span class="dv">1</span>]<span class="sc">+</span>p[<span class="dv">3</span>], <span class="at">b=</span>p[<span class="dv">2</span>]<span class="sc">+</span>p[<span class="dv">4</span>], <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="do">## the result is the same as when we would fit separate linear models</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>fem <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> week, <span class="at">data=</span>dobson, <span class="at">subset =</span> sex<span class="sc">==</span><span class="st">&quot;F&quot;</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>mal <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> week, <span class="at">data=</span>dobson, <span class="at">subset =</span> sex<span class="sc">==</span><span class="st">&quot;M&quot;</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fem, <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">lty=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mal, <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">lty=</span><span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-38-1.png" width="768" /></p>
</div>
<div id="pitfalls-of-the-anova-described-so-far" class="slide section level2">
<h1>Pitfalls of the ANOVA described so far</h1>
<ol style="list-style-type: decimal">
<li>Heterogeneity of variance
<ul>
<li>p-values can be biased (i.e. misleading or wrong)</li>
<li>use of a one-way ANOVA for uneaqual variances (Welch, 1951); in R: <code>oneway.test</code></li>
</ul></li>
<li>Unbalanced case:<br> unequal number of samples for each factor combination
<ul>
<li>ANOVA results depend on the order of factors in the model formula.</li>
<li>Classical method: Type II or Type III ANOVA</li>
<li>Modern approach: model selection and likelihood ratio tests</li>
</ul></li>
</ol>
</div>
<div id="type-ii-and-type-iii-anova" class="slide section level2">
<h1>Type II and Type III ANOVA</h1>
<ul>
<li>function <code>Anova</code> (with upper case <code>A</code>) in package <strong>car</strong></li>
<li>Help of function Anova: “Type-II tests are calculated according to the principle of marginality, testing each term after all others, except ignoring the term’s higher-order relatives; so-called type-III tests violate marginality, testing each term in the model after all of the others.”</li>
<li>Conclusion: use Type II and don’t try to interpret single terms in case of significant interactions.</li>
</ul>
</div>
<div id="type-ii-and-type-iii-anova-example" class="slide section level2">
<h1>Type II and Type III ANOVA: Example</h1>
<p><img src="slides-anova_files/figure-slidy/unnamed-chunk-39-1.png" width="768" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;car&quot;</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> coat <span class="sc">*</span> diet, <span class="at">data =</span> hams)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="st">&quot;II&quot;</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: growth
##            Sum Sq Df F value  Pr(&gt;F)  
## coat      2.61333  1  7.2258 0.03614 *
## diet      2.66000  2  3.6774 0.09069 .
## coat:diet 0.68667  2  0.9493 0.43833  
## Residuals 2.17000  6                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="model-selection-a-paradigm-change" class="slide section level2">
<h1>Model selection – a paradigm change</h1>
<h3 id="problem">Problem:</h3>
<ul>
<li>In complicated models, p-values depend on number (and sometimes of order) of included factors and interactions.</li>
<li>The <span class="math inline">\(H_0\)</span>-based approach becomes confusing, e.g. because of contradictory p-values.</li>
</ul>
<h3 id="alternative-approach">Alternative approach:</h3>
<p>Comparison of different model candidates instead of p-value based testing.</p>
<ul>
<li>Model with all potentiall effects → <span style="color:blue">full model</span>,</li>
<li>Omit single factors → <span style="color:blue">reduced models</span> (several!),</li>
<li>No influence factors (ony mean value) → <span style="color:blue">null model</span>.</li>
<li>Which model is the best → <span style="color:blue">minimal adequate model</span>?</li>
</ul>
</div>
<div id="how-can-we-measure-which-model-is-the-best" class="slide section level2">
<h1>How can we measure which model is the best?</h1>
<p>Compromize between model fit and model complexity (number of parameters, k).</p>
<ul>
<li>Goodness of fit: Likelihood L (measures how good the data match a given model).</li>
<li>Log Likelihood: makes the criterion additive.</li>
<li>AIC (Akaike Information Criterion):</li>
</ul>
<p><span class="math display">\[AIC = −2 \ln(L) + 2k\]</span></p>
<ul>
<li>Alternative: BIC (Bayesian Information Criterion), takes sample size into account (<span class="math inline">\(n\)</span>):</li>
</ul>
<p><span class="math display">\[BIC = −2 \ln(L) + k · \ln(n)\]</span></p>
<p>The model with the smallest AIC (or BIC) is considered as <span style="color:blue">minimal adequate</span> (i.e. optimal) model.</p>
<h3 id="self-study">Self study</h3>
<p>Read the paper of <span class="citation">Johnson &amp; Omland (2004)</span> <a href="https://doi.org/10.1016/j.tree.2003.10.013" class="uri">https://doi.org/10.1016/j.tree.2003.10.013</a> to gain more understanding the model selection paradigm.</p>
</div>
<div id="model-selection-and-likelihood-ratio-tests" class="slide section level2">
<h1>Model Selection and Likelihood Ratio Tests</h1>
<h3 id="approach">Approach</h3>
<ol style="list-style-type: decimal">
<li>Fit several models individually</li>
<li>Compare the models pairwise with ANOVA (likelihood ratio test)</li>
<li>Or: select model with minimum AIC</li>
</ol>
<h3 id="data-and-example">Data and example</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>hams <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">No=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">growth=</span><span class="fu">c</span>(<span class="fl">6.6</span>, <span class="fl">7.2</span>, <span class="fl">6.9</span>, <span class="fl">8.3</span>, <span class="fl">7.9</span>, <span class="fl">9.2</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                            <span class="fl">8.3</span>, <span class="fl">8.7</span>, <span class="fl">8.1</span>, <span class="fl">8.5</span>, <span class="fl">9.1</span>, <span class="fl">9.0</span>),</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diet=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="at">each=</span><span class="dv">2</span>),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">coat=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;light&quot;</span>, <span class="st">&quot;dark&quot;</span>), <span class="at">each=</span><span class="dv">6</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                   )</span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> diet <span class="sc">*</span> coat, <span class="at">data=</span>hams)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> diet <span class="sc">+</span> coat, <span class="at">data=</span>hams)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1, m2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: growth ~ diet * coat
## Model 2: growth ~ diet + coat
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1      6 2.1700                           
## 2      8 2.8567 -2  -0.68667 0.9493 0.4383</code></pre>
<p>The AIC can be shown with <code>AIC</code>:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(m1, m2)</span></code></pre></div>
<pre><code>##    df      AIC
## m1  7 27.53237
## m2  5 26.83151</code></pre>
<ul>
<li>Likelihood ratio test compares two models (<code>anova</code> with &gt; 1 model)</li>
<li>Model with interaction (<code>m1</code>) not significantly better than model without interaction (<code>m2</code>).</li>
</ul>
<p><strong>Conclusion:</strong> take the simpler model (<code>m2</code>)</p>
<p><strong>Exercise:</strong> Generate all possible models and select the model with minimum AIC.</p>
</div>
<div id="automatic-model-selection" class="slide section level2">
<h1>Automatic Model Selection</h1>
<ul>
<li>The full model is supplied to the <code>step</code> function.</li>
<li>The modell with the smallest AIC ist the <span style="color:blue">minimal adequate</span> model:</li>
</ul>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> diet <span class="sc">*</span> coat, <span class="at">data=</span>hams)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(m1)</span></code></pre></div>
<pre><code>## Start:  AIC=-8.52
## growth ~ diet * coat
## 
##             Df Sum of Sq    RSS     AIC
## - diet:coat  2   0.68667 2.8567 -9.2230
## &lt;none&gt;                   2.1700 -8.5222
## 
## Step:  AIC=-9.22
## growth ~ diet + coat
## 
##        Df Sum of Sq    RSS     AIC
## &lt;none&gt;              2.8567 -9.2230
## - diet  2    2.6600 5.5167 -5.3256
## - coat  1    2.6133 5.4700 -3.4275</code></pre>
<pre><code>## 
## Call:
## lm(formula = growth ~ diet + coat, data = hams)
## 
## Coefficients:
## (Intercept)        dietB        dietC    coatlight  
##      8.1667       0.2500       1.1000      -0.9333</code></pre>
</div>
<div id="summary" class="slide section level2">
<h1>Summary</h1>
<ul>
<li>Linear models form the basis of many statistical methods
<ul>
<li>Linear regression</li>
<li>ANOVA, ANCOVA, GLM, GAM, GLMM, . . .</li>
<li>ANOVA/ANCOVA instead of multiple testing</li>
</ul></li>
<li>ANOVA is more powerful than multiple tests:
<ul>
<li>one big experiment needs less n than many small experiments together</li>
<li>identification of interaction effects</li>
<li>elimination of co-variates</li>
</ul></li>
<li>Model selection vs. p-value based testing
<ul>
<li>paradigm shift in statistics: AIC instead of p-value</li>
<li>more reliable, especially for imbalanced or complex designs</li>
<li>but: p-value based tests are sometimes easier to understand</li>
</ul></li>
</ul>
</div>
<div id="avoid-p-value-hacking" class="slide section level2">
<h1>Avoid p-value hacking</h1>
<h3 id="do-not-repeat-experiments-until-a-significant-p-value-is-found.">Do NOT repeat experiments until a significant p-value is found.</h3>
<p>“<strong>As debate rumbles on about how and how much poor statistics is to blame for poor reproducibility, Nature asked influential statisticians to recommend one change to improve science. The common theme? The problem is not our maths, but ourselves.</strong>”</p>
<hr>
</hr>
<h3 id="five-ways-to-fix-statistics.-comment-on-nature.">Five ways to fix statistics. Comment on Nature.</h3>
<p>Leek et al. (2017) <a href="https://doi.org/10.1038/d41586-017-07522-z" class="uri">https://doi.org/10.1038/d41586-017-07522-z</a></p>
<ol style="list-style-type: decimal">
<li>Jeff Leek: Adjust for human cognition</li>
<li>Blakeley B. McShane &amp; Andrew Gelman: Abandon statistical significance</li>
<li>David Colquhoun: State false-positive risk, too</li>
<li>Michèle B. Nuijten: Share analysis plans and results</li>
<li>Steven N. Goodman: Change norms from within</li>
</ol>
<hr>
</hr>
<p>Another blog post that aims to improve understanding: <a href="http://daniellakens.blogspot.de/2017/12/understanding-common-misconceptions.html?m=1" class="uri">http://daniellakens.blogspot.de/2017/12/understanding-common-misconceptions.html?m=1</a></p>
<hr>
</hr>
<p><strong>My conclusion:</strong> The p-value is still useful but apply it with great care.</p>
</div>
<div id="copyright" class="slide section level2">
<h1>Copyright</h1>
<p>This resource was created by <a href="github.com/tpetzoldt">tpetzoldt</a>. It is provided as is without warranty.</p>
</div>
<div id="bibliography" class="slide section level2 unnumbered">
<h1 class="unnumbered">Bibliography</h1>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Crawley2002" class="csl-entry">
Crawley, M. J. (2002). <em>Statistical computing. An introduction to data analysis using <span>S-PLUS</span></em> (pp. 1–761). Wiley. <a href="datasets: http://www.bio.ic.ac.uk/research/mjcraw/statcomp/data/">datasets: http://www.bio.ic.ac.uk/research/mjcraw/statcomp/data/</a>
</div>
<div id="ref-Dobson2013" class="csl-entry">
Dobson, A. J. (2013). <em>Introduction to statistical modelling</em>. Springer.
</div>
<div id="ref-Dziallas2011" class="csl-entry">
Dziallas, C., &amp; Grossart, H.-P. (2011). Increasing <span>Oxygen Radicals</span> and <span>Water Temperature Select</span> for <span>Toxic Microcystis</span> sp. <em>PLoS ONE</em>, <em>6</em>(9), e25569. <a href="https://doi.org/10.1371/journal.pone.0025569">https://doi.org/10.1371/journal.pone.0025569</a>
</div>
<div id="ref-Holm1979" class="csl-entry">
Holm, S. (1979). A simple sequentially rejective multiple test procedure. <em>Scandinavian Journal of Statistics</em>, 65–70. <a href="https://www.jstor.org/stable/4615733">https://www.jstor.org/stable/4615733</a>
</div>
<div id="ref-Jahnichen2007" class="csl-entry">
Jähnichen, S., Ihle, T., Petzoldt, T., &amp; Benndorf, J. (2007). Impact of <span>Inorganic Carbon Availability</span> on <span>Microcystin Production</span> by <span>Microcystis</span> aeruginosa <span>PCC</span> 7806. <em>Applied and Environmental Microbiology</em>, <em>73</em>(21), 6994–7002. <a href="https://doi.org/10.1128/AEM.01253-07">https://doi.org/10.1128/AEM.01253-07</a>
</div>
<div id="ref-Jahnichen2011" class="csl-entry">
Jähnichen, S., Long, B. M., &amp; Petzoldt, T. (2011). Microcystin production by <span>Microcystis</span> aeruginosa: <span>Direct</span> regulation by multiple environmental factors. <em>Harmful Algae</em>, <em>12</em>, 95–104. <a href="https://doi.org/10.1016/j.hal.2011.09.002">https://doi.org/10.1016/j.hal.2011.09.002</a>
</div>
<div id="ref-Jahnichen2001" class="csl-entry">
Jähnichen, S., Petzoldt, T., &amp; Benndorf, J. (2001). Evidence for control of microcystin dynamics in <span>Bautzen Reservoir</span> (<span>Germany</span>) by cyanobacterial population growth rates and dissolved inorganic carbon. <em>Fundamental and Applied Limnology</em>, <em>150</em>(2), 177–196. <a href="https://doi.org/10.1127/archiv-hydrobiol/150/2001/177">https://doi.org/10.1127/archiv-hydrobiol/150/2001/177</a>
</div>
<div id="ref-JohnsonOmland2004" class="csl-entry">
Johnson, G., Jerald, &amp; Omland, K. S. (2004). Model <span>Selection</span> in <span>Ecology</span> and <span>Evolution</span>. <em>Trends in Ecology and Evolution</em>, <em>19</em>(2), 101–108. <a href="https://doi.org/10.1016/j.tree.2003.10.013">https://doi.org/10.1016/j.tree.2003.10.013</a>
</div>
<div id="ref-Zilliges2011" class="csl-entry">
Zilliges, Y., Kehr, J.-C., Meissner, S., Ishida, K., Mikkat, S., Hagemann, M., Kaplan, A., Börner, T., &amp; Dittmann, E. (2011). The <span>Cyanobacterial Hepatotoxin Microcystin Binds</span> to <span>Proteins</span> and <span>Increases</span> the <span>Fitness</span> of <span>Microcystis</span> under <span>Oxidative Stress Conditions</span>. <em>PLoS ONE</em>, <em>6</em>(3), e17615. <a href="https://doi.org/10.1371/journal.pone.0017615">https://doi.org/10.1371/journal.pone.0017615</a>
</div>
</div>
</div>

  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

</body>
</html>
